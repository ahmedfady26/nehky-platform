// Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†ØµØ© Ù†Ø­ÙƒÙŠ - Nehky.com Social Media Platform
// ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ ÙÙŠ 27 ÙŠÙˆÙ†ÙŠÙˆ 2025
// Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙˆØ³Ø¹Ø© Ù„Ø¯Ø¹Ù… Ø§Ù„ÙˆÙŠØ¨ ÙˆØ§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„ØªØ§Ø¨Ù„Øª

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========================================
// ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† - Users
// ========================================

model User {
  id                 String    @id @default(uuid())
  firstName          String    @map("first_name") // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„
  secondName         String?   @map("second_name") // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  thirdName          String?   @map("third_name") // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø« (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  lastName           String    @map("last_name") // Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
  fullName           String    @map("full_name") // Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (ÙŠØªÙ… ØªØ¬Ù…ÙŠØ¹Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
  username           String    @unique
  nehkyEmail         String    @unique @map("nehky_email") // Auto-generated: username@nehky.com
  externalEmail      String?   @map("external_email") // Optional external email (Gmail, Yahoo, etc.)
  phone              String    @unique // Must be unique across platform
  phoneVerified      Boolean   @default(false) @map("phone_verified") // Phone verification status
  otpCode            String?   @map("otp_code") // Current OTP code for phone verification
  otpExpiresAt       DateTime? @map("otp_expires_at") // OTP expiration time
  otpAttempts        Int       @default(0) @map("otp_attempts") // Number of OTP attempts
  lastOtpSentAt      DateTime? @map("last_otp_sent_at") // Last time OTP was sent
  passwordHash       String    @map("password_hash")
  gender             Gender?
  age                Int?
  graduationYear     Int?      @map("graduation_year")
  certificate        String?
  highSchool         String?   @map("high_school")
  nationality        String?
  countryOfOrigin    String?   @map("country_of_origin")
  countryOfResidence String?   @map("country_of_residence")
  hobbies            String[] // Array of hobbies
  interests          String[] // Array of interests
  role               UserRole  @default(NORMAL)

  // Additional fields for platform functionality
  isVerified     Boolean   @default(false) @map("is_verified")
  isInfluencer   Boolean   @default(false) @map("is_influencer") // Influencer from external platforms
  profilePicture String?   @map("profile_picture")
  coverPicture   String?   @map("cover_picture")
  bio            String?
  followersCount Int       @default(0) @map("followers_count")
  followingCount Int       @default(0) @map("following_count")
  postsCount     Int       @default(0) @map("posts_count")
  isActive       Boolean   @default(true) @map("is_active")
  lastSeenAt     DateTime? @map("last_seen_at")

  // Registration security tracking
  registrationIp        String? @map("registration_ip") // IP address during registration
  registrationUserAgent String? @map("registration_user_agent") // User agent during registration
  registrationGeo       String? @map("registration_geo") // Geographic location during registration
  deviceFingerprint     String? @map("device_fingerprint") // Device fingerprint for security
  referrerId            String? @map("referrer_id") // User who referred this user
  fakeScore             Float   @default(0) @map("fake_score") // Probability of being a fake account (0-1)

  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  lastActivity DateTime @default(now()) @map("last_activity") // Ø¢Ø®Ø± Ù†Ø´Ø§Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…

  // Relations
  posts        Post[]
  interactions Interaction[]
  userScores   UserScore[]

  // ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  videoViewSessions VideoViewSession[]

  // Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
  followers UserFollow[] @relation("UserFollowing") // Ù…Ù† ÙŠØªØ§Ø¨Ø¹Ù†ÙŠ
  following UserFollow[] @relation("UserFollowers") // Ù…Ù† Ø£ØªØ§Ø¨Ø¹Ù‡Ù…

  // Signatures
  influencerSignatures UserSignature[] @relation("InfluencerSignatures")
  followerSignatures   UserSignature[] @relation("FollowerSignatures")

  // Nominations
  influencerNominations Nomination[] @relation("InfluencerNominations")
  candidateNominations  Nomination[] @relation("CandidateNominations")

  // Video system
  videoChannels VideoChannel[]

  // Messaging
  createdConversations Conversation[]       @relation("ConversationCreator")
  conversationMembers  ConversationMember[]
  sentMessages         Message[]

  // Admin system
  adminProfile Admin?

  // Influencer external accounts
  influencerAccounts InfluencerAccount[]

  // Device tracking
  loginSessions LoginSession[]

  // Notifications
  notifications Notification[]

  // Reports
  sentReports     Report[] @relation("Reporter")
  reviewedReports Report[] @relation("Reviewer")

  // User blocks
  blockedByMe UserBlock[] @relation("Blocker")
  blockedMe   UserBlock[] @relation("Blocked")

  // Activity and interests
  activityLogs ActivityLog[]

  // Advanced tracking relations
  scrollTrackings      UserScrollTracking[]      @relation("UserScrollTracking")
  videoTrackings       UserVideoTracking[]       @relation("UserVideoTracking")
  interactionTrackings UserInteractionTracking[] @relation("UserInteractionTracking")
  smartProfiles        SmartUserProfile[]        @relation("UserSmartProfiles")

  // Requests - will be added later
  // sentRequests     PendingRequest[] @relation("Sender")
  // receivedRequests PendingRequest[] @relation("Receiver")

  // Security - will be added later
  // securitySettings UserSecuritySetting?

  // Detailed activity tracking - will be added later
  // detailedActivityLogs DetailedActivityLog[] @relation("DetailedActivityUser")

  // Post viewing tracking - will be added later
  // postViews UserPostView[] @relation("UserPostViews")

  // Interest system
  interestProfile UserInterestProfile?
  interestScores  UserInterestScore[]

  // Post interest mapping
  postInterestMappings UserPostInterestMapping[]

  // Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ø§Ù„ØªÙŠ Ø£Ù†Ø´Ø£Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  campaigns Campaign[]

  // Ø§Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠ
  sponsoredUserTargets SponsoredUserTarget[]

  // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ù…ÙØ¹Ø·Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹
  // paymentMethods UserPaymentMethod[]  @relation("UserPaymentMethods")
  // invoices       SponsoredAdInvoice[] @relation("UserInvoices")
  // payments       OnlinePayment[]      @relation("UserPayments")

  // Ù†Ø¸Ø§Ù… Ø¯ÙØ¹ Ø§Ù„Ù…Ø¤Ø«Ø±ÙŠÙ† - Ù…ÙØ¹Ø·Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹
  // influencerContracts    InfluencerContract[]    @relation("InfluencerContracts")
  // influencerEarnings     InfluencerEarning[]     @relation("InfluencerEarnings")
  // influencerPaymentInfos InfluencerPaymentInfo[] @relation("InfluencerPaymentInfos")
  // influencerPayments     InfluencerPayment[]     @relation("InfluencerPayments")
  // influencerPerformances InfluencerPerformance[] @relation("InfluencerPerformances")

  // Referral system
  referrer          User?              @relation("UserReferral", fields: [referrerId], references: [id])
  referredUsers     User[]             @relation("UserReferral")
  referralAuditLogs ReferralAuditLog[] @relation("ReferralAuditLogs")
  referrerAuditLogs ReferralAuditLog[] @relation("ReferrerAuditLogs")

  // Ù†Ø¸Ø§Ù… Ø§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø£ÙØ¶Ù„ - Best Friend System
  bestFriendAsUser1          BestFriendRelation[]          @relation("BestFriendUser1")
  bestFriendAsUser2          BestFriendRelation[]          @relation("BestFriendUser2")
  permissionRequestsSent     BestFriendPermissionRequest[] @relation("PermissionRequester")
  permissionRequestsReceived BestFriendPermissionRequest[] @relation("PermissionApprover")
  bestFriendActivities       BestFriendActivityLog[]       @relation("BestFriendActivities")

  @@index([username])
  @@index([nehkyEmail])
  @@index([phone])
  @@index([externalEmail])
  @@index([role])
  @@index([isActive])
  @@index([isInfluencer])
  @@index([createdAt])
  @@index([lastSeenAt])
  @@map("users")
}

enum Gender {
  MALE
  FEMALE
  OTHER
  PREFER_NOT_TO_SAY
}

enum UserRole {
  NORMAL
  INFLUENCER
  ADMIN
}

// Accountant System Enums
enum AccountantRole {
  JUNIOR_ACCOUNTANT // Ù…Ø­Ø§Ø³Ø¨ Ù…Ø¨ØªØ¯Ø¦
  SENIOR_ACCOUNTANT // Ù…Ø­Ø§Ø³Ø¨ Ù…Ø¹ØªÙ…Ø¯
  AUDITOR // Ù…Ø±Ø§Ø¬Ø¹
  FINANCE_MANAGER // Ù…Ø¯ÙŠØ± Ù…Ø§Ù„ÙŠ
}

// Financial System Enums
enum ExpenseCategory {
  OPERATIONS // ØªØ´ØºÙŠÙ„
  MARKETING // ØªØ³ÙˆÙŠÙ‚
  TAXES // Ø¶Ø±Ø§Ø¦Ø¨
  SALARIES // Ø±ÙˆØ§ØªØ¨
  RENT // Ø¥ÙŠØ¬Ø§Ø±
  UTILITIES // Ù…Ø±Ø§ÙÙ‚
  EQUIPMENT // Ù…Ø¹Ø¯Ø§Øª
  SOFTWARE // Ø¨Ø±Ù…Ø¬ÙŠØ§Øª
  LEGAL // Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©
  CONSULTING // Ø§Ø³ØªØ´Ø§Ø±Ø§Øª
  TRAVEL // Ø³ÙØ±
  ENTERTAINMENT // ØªØ±ÙÙŠÙ‡
  INSURANCE // ØªØ£Ù…ÙŠÙ†
  MAINTENANCE // ØµÙŠØ§Ù†Ø©
  OTHER // Ø£Ø®Ø±Ù‰
}

enum RevenueSource {
  SUBSCRIPTION // Ø§Ø´ØªØ±Ø§Ùƒ
  ADVERTISING // Ø¥Ø¹Ù„Ø§Ù†
  SPONSORED_VIDEO // ÙÙŠØ¯ÙŠÙˆ Ù…Ù…ÙˆÙ„
  SPONSORED_POST // Ù…Ù†Ø´ÙˆØ± Ù…Ù…ÙˆÙ„
  PARTNERSHIP // Ø´Ø±Ø§ÙƒØ©
  COMMISSION // Ø¹Ù…ÙˆÙ„Ø©
  DONATION // ØªØ¨Ø±Ø¹
  MERCHANDISE // Ø¨Ø¶Ø§Ø¦Ø¹
  LICENSING // ØªØ±Ø®ÙŠØµ
  CONSULTATION // Ø§Ø³ØªØ´Ø§Ø±Ø©
  OTHER // Ø£Ø®Ø±Ù‰
}

enum PeriodType {
  MONTHLY // Ø´Ù‡Ø±ÙŠ
  QUARTERLY // Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ
  SEMI_ANNUALLY // Ù†ØµÙ Ø³Ù†ÙˆÙŠ
  ANNUALLY // Ø³Ù†ÙˆÙŠ
  CUSTOM // Ù…Ø®ØµØµ
}

enum TaxReportType {
  VAT // Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©
  INCOME_TAX // Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ø®Ù„
  CORPORATE_TAX // Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª
  WITHHOLDING_TAX // Ø¶Ø±ÙŠØ¨Ø© Ø§Ø³ØªÙ‚Ø·Ø§Ø¹
  COMBINED // Ù…Ø¬Ù…Ø¹
}

enum TaxReportStatus {
  DRAFT // Ù…Ø³ÙˆØ¯Ø©
  SUBMITTED // ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  PAID // ØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯
  APPROVED // ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
  REJECTED // Ù…Ø±ÙÙˆØ¶
  UNDER_REVIEW // ØªØ­Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
}

// Online Payment System Enums
enum PaymentGateway {
  FAWRY // ÙÙˆØ±ÙŠ
  PAYMOB // Ø¨Ø§ÙŠ Ù…ÙˆØ¨
  ACCEPT // Ø£ÙƒØ³Ø¨Øª
  VODAFONE_CASH // ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´
  ORANGE_MONEY // Ø£ÙˆØ±Ø§Ù†Ø¬ Ù…ÙˆÙ†ÙŠ
  ETISALAT_CASH // Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´
  AMAN // Ø£Ù…Ø§Ù†
  MASARY // Ù…ØµØ§Ø±ÙŠ
  BANK_TRANSFER // ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ
  CREDIT_CARD // Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†
  DEBIT_CARD // Ø¨Ø·Ø§Ù‚Ø© Ø®ØµÙ…
  DIGITAL_WALLET // Ù…Ø­ÙØ¸Ø© Ø±Ù‚Ù…ÙŠØ©
  INSTALLMENTS // Ø£Ù‚Ø³Ø§Ø·
  OTHER // Ø£Ø®Ø±Ù‰
}

enum PaymentMethodType {
  CARD // Ø¨Ø·Ø§Ù‚Ø©
  WALLET // Ù…Ø­ÙØ¸Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©
  BANK_ACCOUNT // Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙŠ
  MOBILE_PAYMENT // Ø¯ÙØ¹ Ù…ÙˆØ¨Ø§ÙŠÙ„
  INSTALLMENT_PLAN // Ø®Ø·Ø© Ø£Ù‚Ø³Ø§Ø·
}

enum CardType {
  VISA // ÙÙŠØ²Ø§
  MASTERCARD // Ù…Ø§Ø³ØªØ±ÙƒØ§Ø±Ø¯
  AMERICAN_EXPRESS // Ø£Ù…Ø±ÙŠÙƒØ§Ù† Ø¥ÙƒØ³Ø¨Ø±ÙŠØ³
  MEEZA // Ù…ÙŠØ²Ø©
  OTHER // Ø£Ø®Ø±Ù‰
}

enum InvoiceStatus {
  DRAFT // Ù…Ø³ÙˆØ¯Ø©
  SENT // ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  VIEWED // ØªÙ… Ø§Ù„Ø¹Ø±Ø¶
  PAID // ØªÙ… Ø§Ù„Ø¯ÙØ¹
  PARTIALLY_PAID // Ø¯ÙØ¹ Ø¬Ø²Ø¦ÙŠ
  OVERDUE // Ù…ØªØ£Ø®Ø±
  CANCELLED // Ù…Ù„ØºÙŠ
  REFUNDED // Ù…Ø³ØªØ±Ø¯
}

enum PaymentProcessorStatus {
  PENDING // Ù…Ø¹Ù„Ù‚
  PROCESSING // Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
  COMPLETED // Ù…ÙƒØªÙ…Ù„
  FAILED // ÙØ´Ù„
  CANCELLED // Ù…Ù„ØºÙŠ
  REFUNDED // Ù…Ø³ØªØ±Ø¯
  DISPUTED // Ù…ØªÙ†Ø§Ø²Ø¹ Ø¹Ù„ÙŠÙ‡
  EXPIRED // Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
}

// Influencer Payment System Enums
enum InfluencerContractType {
  PER_POST // Ù„ÙƒÙ„ Ù…Ù†Ø´ÙˆØ±
  PER_VIDEO // Ù„ÙƒÙ„ ÙÙŠØ¯ÙŠÙˆ
  MONTHLY_RETAINER // Ø±Ø§ØªØ¨ Ø´Ù‡Ø±ÙŠ
  CAMPAIGN_BASED // Ø­Ø³Ø¨ Ø§Ù„Ø­Ù…Ù„Ø©
  COMMISSION_BASED // Ø­Ø³Ø¨ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©
  PERFORMANCE_BASED // Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¯Ø§Ø¡
  HYBRID // Ù…Ø®ØªÙ„Ø·
}

enum ContractStatus {
  DRAFT // Ù…Ø³ÙˆØ¯Ø©
  PENDING_APPROVAL // ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
  ACTIVE // Ù†Ø´Ø·
  PAUSED // Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹
  COMPLETED // Ù…ÙƒØªÙ…Ù„
  CANCELLED // Ù…Ù„ØºÙŠ
  EXPIRED // Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
  TERMINATED // Ù…Ù†Ù‡ÙŠ
}

enum InfluencerPaymentStatus {
  PENDING // Ù…Ø¹Ù„Ù‚
  APPROVED // Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡
  PROCESSING // Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
  COMPLETED // Ù…ÙƒØªÙ…Ù„
  FAILED // ÙØ´Ù„
  ON_HOLD // Ù…Ø­Ø¬ÙˆØ²
  DISPUTED // Ù…ØªÙ†Ø§Ø²Ø¹ Ø¹Ù„ÙŠÙ‡
  CANCELLED // Ù…Ù„ØºÙŠ
}

enum InfluencerPaymentMethod {
  BANK_TRANSFER // ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ
  MOBILE_WALLET // Ù…Ø­ÙØ¸Ø© Ù…ÙˆØ¨Ø§ÙŠÙ„
  PAYPAL // Ø¨Ø§ÙŠ Ø¨Ø§Ù„
  WISE // ÙˆØ§ÙŠØ² (ØªØ±Ø§Ù†Ø³ÙØ± ÙˆØ§ÙŠØ²)
  WESTERN_UNION // ÙˆÙŠØ³ØªØ±Ù† ÙŠÙˆÙ†ÙŠÙˆÙ†
  VODAFONE_CASH // ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´
  ORANGE_MONEY // Ø£ÙˆØ±Ø§Ù†Ø¬ Ù…ÙˆÙ†ÙŠ
  FAWRY // ÙÙˆØ±ÙŠ
  CHECK // Ø´ÙŠÙƒ
  CASH // Ù†Ù‚Ø¯Ø§Ù‹
  CRYPTO // Ø¹Ù…Ù„Ø© Ø±Ù‚Ù…ÙŠØ©
  OTHER // Ø£Ø®Ø±Ù‰
}

enum CommissionType {
  FIXED_AMOUNT // Ù…Ø¨Ù„Øº Ø«Ø§Ø¨Øª
  PERCENTAGE // Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ©
  TIERED // Ù…ØªØ¯Ø±Ø¬ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¯Ø§Ø¡
  BONUS_BASED // Ø­Ø³Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª
  MIXED // Ù…Ø®ØªÙ„Ø·
}

// ========================================
// ğŸŒŸ Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø¤Ø«Ø±ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© - External Influencer Accounts
// ========================================

model InfluencerAccount {
  id             String           @id @default(uuid())
  userId         String           @map("user_id")
  platformName   ExternalPlatform @map("platform_name")
  platformLink   String           @map("platform_link")
  followersCount Int              @default(0) @map("followers_count")

  // Verification status
  isVerified Boolean   @default(false) @map("is_verified")
  verifiedAt DateTime? @map("verified_at")

  // Activity tracking
  isActive Boolean @default(true) @map("is_active")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, platformName]) // One account per platform per user
  @@index([userId])
  @@index([platformName])
  @@index([followersCount])
  @@index([isVerified])
  @@index([isActive])
  @@map("influencer_accounts")
}

enum ExternalPlatform {
  INSTAGRAM
  TIKTOK
  YOUTUBE
  TWITTER
  FACEBOOK
  SNAPCHAT
  LINKEDIN
  TELEGRAM
  WHATSAPP
  CLUBHOUSE
  PINTEREST
  REDDIT
  TWITCH
  OTHER
}

// ========================================
// ğŸ“ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ ÙˆØ§Ù„Ù†Ù‚Ø§Ø· - Posts, Interactions & Scores
// ========================================

model Post {
  id         String         @id @default(uuid())
  userId     String         @map("user_id")
  content    String
  mediaUrl   String?        @map("media_url")
  mediaType  MediaType?     @map("media_type")
  visibility PostVisibility @default(PUBLIC)

  // Counters
  likesCount    Int @default(0) @map("likes_count")
  commentsCount Int @default(0) @map("comments_count")
  sharesCount   Int @default(0) @map("shares_count")
  viewsCount    Int @default(0) @map("views_count")

  // Status
  isDeleted Boolean @default(false) @map("is_deleted")
  isPinned  Boolean @default(false) @map("is_pinned")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user           User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  interactions   Interaction[]
  userScores     UserScore[]
  hashtags       PostHashtag[]
  reports        Report[]
  classification PostClassification?

  // Post analytics and user interest mapping
  attractiveness       PostAttractiveness?
  userInterestMappings UserPostInterestMapping[]

  // ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  videoViewSessions VideoViewSession[]
  videoMetrics      VideoMetrics?

  // Advanced tracking relations
  scrollTrackings      UserScrollTracking[]      @relation("PostScrollTracking")
  videoTrackings       UserVideoTracking[]       @relation("PostVideoTracking")
  interactionTrackings UserInteractionTracking[] @relation("PostInteractionTracking")

  // Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
  sponsoredPosts SponsoredPost[]

  // Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¤Ø«Ø±ÙŠÙ† Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ± - Ù…ÙØ¹Ø·Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹
  // influencerEarnings InfluencerEarning[] @relation("PostEarnings")

  @@index([userId])
  @@index([visibility])
  @@index([createdAt])
  @@index([isDeleted])
  @@index([isPinned])
  @@map("posts")
}

model Interaction {
  id       String          @id @default(uuid())
  postId   String          @map("post_id")
  userId   String          @map("user_id")
  type     InteractionType
  content  String? // For comments
  parentId String?         @map("parent_id") // For comment replies

  // Comment features
  likesCount Int     @default(0) @map("likes_count")
  isDeleted  Boolean @default(false) @map("is_deleted")

  // Speed-based scoring system
  reactionSpeedMultiplier Float? @default(1.0) @map("reaction_speed_multiplier") // Speed multiplier based on reaction time
  adjustedPoints          Int?   @default(0) @map("adjusted_points") // Final points after speed calculation

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  post       Post          @relation(fields: [postId], references: [id], onDelete: Cascade)
  user       User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  parent     Interaction?  @relation("CommentReplies", fields: [parentId], references: [id])
  replies    Interaction[] @relation("CommentReplies")
  userScores UserScore[]
  reports    Report[]

  @@unique([postId, userId, type]) // Prevent duplicate likes from same user
  @@index([postId])
  @@index([userId])
  @@index([type])
  @@index([parentId])
  @@index([createdAt])
  @@map("interactions")
}

model UserScore {
  id              String          @id @default(uuid())
  userId          String          @map("user_id")
  postId          String          @map("post_id")
  interactionId   String?         @map("interaction_id")
  interactionType InteractionType @map("interaction_type")
  points          Int
  interactionTime DateTime        @map("interaction_time")
  calculatedScore Float           @map("calculated_score") // Based on interaction speed
  speedCategory   SpeedCategory   @map("speed_category")

  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  user        User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  post        Post         @relation(fields: [postId], references: [id], onDelete: Cascade)
  interaction Interaction? @relation(fields: [interactionId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([postId])
  @@index([interactionType])
  @@index([speedCategory])
  @@index([interactionTime])
  @@index([calculatedScore])
  @@map("user_scores")
}

enum MediaType {
  IMAGE
  VIDEO
  AUDIO
  DOCUMENT
  GIF
}

enum PostVisibility {
  PUBLIC
  FRIENDS
  PRIVATE
}

enum InteractionType {
  LIKE
  COMMENT
  SHARE
  VIEW
  SAVE
}

enum SpeedCategory {
  FAST // 0-5 minutes
  MEDIUM // 5-30 minutes
  SLOW // 30+ minutes
}

// ========================================
// âœï¸ Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹ - User Signatures
// ========================================

model UserSignature {
  id            String  @id @default(uuid())
  influencerId  String  @map("influencer_id")
  followerId    String  @map("follower_id")
  signatureText String  @map("signature_text")
  isActive      Boolean @default(true) @map("is_active")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  influencer User @relation("InfluencerSignatures", fields: [influencerId], references: [id], onDelete: Cascade)
  follower   User @relation("FollowerSignatures", fields: [followerId], references: [id], onDelete: Cascade)

  @@unique([influencerId, followerId]) // One signature per relationship
  @@index([influencerId])
  @@index([followerId])
  @@index([isActive])
  @@map("user_signatures")
}

// ========================================
// ğŸ† Ø§Ù„ØªØ±Ø´ÙŠØ­Ø§Øª - Nominations
// ========================================

model Nomination {
  id               String           @id @default(uuid())
  influencerId     String           @map("influencer_id")
  candidateUserId  String           @map("candidate_user_id")
  scoreSnapshot    Float            @map("score_snapshot")
  status           NominationStatus @default(PENDING)
  nominatedAt      DateTime         @default(now()) @map("nominated_at")
  decisionDeadline DateTime         @map("decision_deadline")
  respondedAt      DateTime?        @map("responded_at")

  // Additional tracking
  notes      String?
  week       String // Format: "2025-W27"
  year       Int
  weekNumber Int     @map("week_number")
  isExpired  Boolean @default(false) @map("is_expired")

  // Relations
  influencer User @relation("InfluencerNominations", fields: [influencerId], references: [id], onDelete: Cascade)
  candidate  User @relation("CandidateNominations", fields: [candidateUserId], references: [id], onDelete: Cascade)

  @@unique([influencerId, week]) // One nomination per influencer per week
  @@index([influencerId])
  @@index([candidateUserId])
  @@index([status])
  @@index([week])
  @@index([decisionDeadline])
  @@index([isExpired])
  @@index([nominatedAt])
  @@map("nominations")
}

enum NominationStatus {
  PENDING
  ACCEPTED
  REJECTED
  EXPIRED
}

// ========================================
// ğŸ“º Ù‚Ù†ÙˆØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª - Video Channels & Videos
// ========================================

model VideoChannel {
  id           String  @id @default(uuid())
  userId       String  @map("user_id")
  name         String
  description  String?
  thumbnailUrl String? @map("thumbnail_url")

  // Statistics
  subscribersCount Int @default(0) @map("subscribers_count")
  videosCount      Int @default(0) @map("videos_count")
  totalViews       Int @default(0) @map("total_views")

  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  videos    Video[]
  playlists Playlist[]

  @@index([userId])
  @@index([isActive])
  @@index([subscribersCount])
  @@index([createdAt])
  @@map("video_channels")
}

model Video {
  id           String  @id @default(uuid())
  channelId    String  @map("channel_id")
  title        String
  description  String?
  videoUrl     String  @map("video_url")
  thumbnailUrl String? @map("thumbnail_url")

  // Video properties
  duration   Int? // in seconds
  visibility PostVisibility @default(PUBLIC)

  // Statistics
  viewsCount    Int @default(0) @map("views_count")
  likesCount    Int @default(0) @map("likes_count")
  dislikesCount Int @default(0) @map("dislikes_count")
  commentsCount Int @default(0) @map("comments_count")

  // Content organization
  tags     String[] // Array of tags
  category String?

  // Status
  isProcessing Boolean @default(true) @map("is_processing")
  isDeleted    Boolean @default(false) @map("is_deleted")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  channel       VideoChannel   @relation(fields: [channelId], references: [id], onDelete: Cascade)
  playlistItems PlaylistItem[]
  reports       Report[]

  // Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  sponsoredVideos SponsoredVideo[]

  @@index([channelId])
  @@index([visibility])
  @@index([viewsCount])
  @@index([createdAt])
  @@index([isDeleted])
  @@index([category])
  @@map("videos")
}

model Playlist {
  id           String  @id @default(uuid())
  channelId    String  @map("channel_id")
  name         String
  description  String?
  thumbnailUrl String? @map("thumbnail_url")

  // Statistics
  videosCount   Int @default(0) @map("videos_count")
  totalViews    Int @default(0) @map("total_views")
  totalDuration Int @default(0) @map("total_duration") // in seconds

  isPublic  Boolean  @default(true) @map("is_public")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  channel VideoChannel   @relation(fields: [channelId], references: [id], onDelete: Cascade)
  items   PlaylistItem[]

  @@index([channelId])
  @@index([isPublic])
  @@index([createdAt])
  @@map("playlists")
}

model PlaylistItem {
  id         String   @id @default(uuid())
  playlistId String   @map("playlist_id")
  videoId    String   @map("video_id")
  position   Int
  addedAt    DateTime @default(now()) @map("added_at")

  // Relations
  playlist Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  video    Video    @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([playlistId, videoId]) // Prevent duplicate videos in same playlist
  @@index([playlistId])
  @@index([videoId])
  @@index([position])
  @@map("playlist_items")
}

// ========================================
// ğŸ’¬ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„ - Conversations & Messages
// ========================================

model Conversation {
  id              String           @id @default(uuid())
  type            ConversationType @default(PRIVATE)
  name            String? // For group conversations
  description     String?
  avatarUrl       String?          @map("avatar_url")
  createdByUserId String           @map("created_by_user_id")

  // Last message tracking
  lastMessageId String?   @map("last_message_id")
  lastMessageAt DateTime? @map("last_message_at")

  // Statistics
  membersCount  Int @default(0) @map("members_count")
  messagesCount Int @default(0) @map("messages_count")

  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  createdBy User                 @relation("ConversationCreator", fields: [createdByUserId], references: [id])
  members   ConversationMember[]
  messages  Message[]

  @@index([type])
  @@index([createdByUserId])
  @@index([lastMessageAt])
  @@index([isActive])
  @@index([createdAt])
  @@map("conversations")
}

model ConversationMember {
  id             String     @id @default(uuid())
  conversationId String     @map("conversation_id")
  userId         String     @map("user_id")
  role           MemberRole @default(MEMBER)

  // Read tracking
  lastReadAt  DateTime? @map("last_read_at")
  unreadCount Int       @default(0) @map("unread_count")

  // Settings
  isMuted Boolean @default(false) @map("is_muted")

  joinedAt DateTime  @default(now()) @map("joined_at")
  leftAt   DateTime? @map("left_at")

  // Relations
  conversation Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([conversationId, userId])
  @@index([conversationId])
  @@index([userId])
  @@index([role])
  @@index([lastReadAt])
  @@map("conversation_members")
}

model Message {
  id             String      @id @default(uuid())
  conversationId String      @map("conversation_id")
  senderId       String      @map("sender_id")
  messageType    MessageType @map("message_type")
  content        String? // For text messages
  mediaUrl       String?     @map("media_url") // For media messages

  // File properties
  fileName String? @map("file_name")
  fileSize Int?    @map("file_size") // in bytes

  // Reply system
  replyToId String? @map("reply_to_id")

  // Message status
  isEdited    Boolean @default(false) @map("is_edited")
  isDeleted   Boolean @default(false) @map("is_deleted")
  readByCount Int     @default(0) @map("read_by_count")

  sentAt   DateTime  @default(now()) @map("sent_at")
  editedAt DateTime? @map("edited_at")

  // Relations
  conversation Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  sender       User         @relation(fields: [senderId], references: [id], onDelete: Cascade)
  replyTo      Message?     @relation("MessageReplies", fields: [replyToId], references: [id])
  replies      Message[]    @relation("MessageReplies")
  reports      Report[]

  @@index([conversationId])
  @@index([senderId])
  @@index([messageType])
  @@index([sentAt])
  @@index([isDeleted])
  @@index([replyToId])
  @@map("messages")
}

enum ConversationType {
  PRIVATE
  GROUP
}

enum MemberRole {
  ADMIN
  MODERATOR
  MEMBER
}

enum MessageType {
  TEXT
  IMAGE
  VIDEO
  FILE
  VOICE
  STICKER
  GIF
}

// ========================================
// ğŸ‘®â€â™‚ï¸ Ø§Ù„Ù…Ø´Ø±ÙÙˆÙ† ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª - Admins & Permissions
// ========================================

model Admin {
  id         String    @id @default(uuid())
  userId     String    @unique @map("user_id")
  role       AdminRole @default(MODERATOR)
  assignedBy String?   @map("assigned_by")
  assignedAt DateTime  @default(now()) @map("assigned_at")

  // Status
  isActive     Boolean   @default(true) @map("is_active")
  lastActiveAt DateTime? @map("last_active_at")

  // Additional info
  notes      String?
  department String?

  // Required files for admin verification
  cvFile             String? @map("cv_file") // CV file path or text
  criminalRecordFile String? @map("criminal_record_file") // Criminal record document
  profileImage       String? @map("profile_image") // Admin profile photo

  // Verification status
  isVerified Boolean   @default(false) @map("is_verified")
  verifiedBy String?   @map("verified_by") // Super admin who verified
  verifiedAt DateTime? @map("verified_at")

  // Relations
  user            User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  permissions     AdminPermission[]
  reviewedReports Report[]

  @@index([role])
  @@index([isActive])
  @@index([assignedAt])
  @@index([lastActiveAt])
  @@index([isVerified])
  @@map("admins")
}

model AdminPermission {
  id        String       @id @default(uuid())
  adminId   String       @map("admin_id")
  section   AdminSection
  canView   Boolean      @default(false) @map("can_view")
  canEdit   Boolean      @default(false) @map("can_edit")
  canDelete Boolean      @default(false) @map("can_delete")
  canBan    Boolean      @default(false) @map("can_ban")

  grantedAt DateTime @default(now()) @map("granted_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // Relations
  admin Admin @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@unique([adminId, section]) // One permission record per section per admin
  @@index([adminId])
  @@index([section])
  @@map("admin_permissions")
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
  MODERATOR
}

enum AdminSection {
  USERS
  CONTENT
  VIDEOS
  ANALYTICS
  MESSAGING
  REPORTS
  NOMINATIONS
  SETTINGS
}

// ========================================
// ğŸ” ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙˆØ§Ù„Ø¬Ù„Ø³Ø§Øª - Login Sessions & Device Tracking
// ========================================

model LoginSession {
  id        String @id @default(uuid())
  userId    String @map("user_id")
  ipAddress String @map("ip_address")

  // Location data
  country  String?
  region   String?
  city     String?
  timezone String?

  // Device information
  deviceType        DeviceType @map("device_type")
  os                String?
  browser           String?
  userAgent         String     @map("user_agent")
  deviceFingerprint String?    @map("device_fingerprint")

  // Session status
  isActive     Boolean @default(true) @map("is_active")
  isSuspicious Boolean @default(false) @map("is_suspicious")

  // Timestamps
  loginTime      DateTime  @default(now()) @map("login_time")
  logoutTime     DateTime? @map("logout_time")
  lastActivityAt DateTime  @default(now()) @map("last_activity_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([ipAddress])
  @@index([deviceType])
  @@index([isActive])
  @@index([loginTime])
  @@index([lastActivityAt])
  @@index([isSuspicious])
  @@map("login_sessions")
}

enum DeviceType {
  DESKTOP
  MOBILE
  TABLET
  UNKNOWN
}

// ========================================
// ğŸ“ˆ Ø§Ù„ØªØ±Ù†Ø¯Ø§Øª ÙˆØ§Ù„Ù‡Ø§Ø´ØªØ§Øº ÙˆØ§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© - Trends, Hashtags & Keywords
// ========================================

model Hashtag {
  id         String @id @default(uuid())
  name       String @unique
  usageCount Int    @default(1) @map("usage_count")
  trendScore Float  @default(0) @map("trend_score")

  // Trend tracking
  dailyUsage  Int @default(0) @map("daily_usage")
  weeklyUsage Int @default(0) @map("weekly_usage")
  peakUsage   Int @default(0) @map("peak_usage")

  // Timestamps
  lastUsedAt DateTime  @default(now()) @map("last_used_at")
  peakAt     DateTime? @map("peak_at")
  createdAt  DateTime  @default(now()) @map("created_at")
  updatedAt  DateTime  @default(now()) @map("updated_at")

  // Relations
  posts          PostHashtag[]
  trendingTopics TrendingTopic[]

  @@index([name])
  @@index([usageCount])
  @@index([trendScore])
  @@index([lastUsedAt])
  @@index([dailyUsage])
  @@index([weeklyUsage])
  @@map("hashtags")
}

model PostHashtag {
  id          String   @id @default(uuid())
  postId      String   @map("post_id")
  hashtagId   String   @map("hashtag_id")
  extractedAt DateTime @default(now()) @map("extracted_at")

  // Relations
  post    Post    @relation(fields: [postId], references: [id], onDelete: Cascade)
  hashtag Hashtag @relation(fields: [hashtagId], references: [id], onDelete: Cascade)

  @@unique([postId, hashtagId])
  @@index([postId])
  @@index([hashtagId])
  @@index([extractedAt])
  @@map("post_hashtags")
}

model Keyword {
  id                 String  @id @default(uuid())
  keyword            String
  weight             Float   @default(1.0)
  detectedFromPostId String? @map("detected_from_post_id")

  // Classification
  category  String?
  sentiment Float? // Sentiment analysis score (-1 to 1)
  language  String? @default("ar") // Language detected

  // Usage tracking
  usageCount  Int @default(1) @map("usage_count")
  dailyUsage  Int @default(0) @map("daily_usage")
  weeklyUsage Int @default(0) @map("weekly_usage")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  trendingTopics TrendingTopic[]

  @@index([keyword])
  @@index([weight])
  @@index([category])
  @@index([usageCount])
  @@index([language])
  @@index([sentiment])
  @@map("keywords")
}

model TrendingTopic {
  id          String    @id @default(uuid())
  title       String
  type        TrendType
  referenceId String    @map("reference_id") // hashtag_id or keyword_id

  // Trend metrics
  trendScore Float @map("trend_score")
  velocity   Float @default(0) // Rate of growth
  momentum   Float @default(0) // Sustained growth

  // Peak tracking
  peakScore Float     @default(0) @map("peak_score")
  peakAt    DateTime? @map("peak_at")

  // Classification
  category String?
  region   String?
  ageGroup String? @map("age_group")

  // Status
  isActive Boolean @default(true) @map("is_active")

  detectedAt DateTime @default(now()) @map("detected_at")
  updatedAt  DateTime @default(now()) @map("updated_at")

  // Relations
  hashtag Hashtag? @relation(fields: [referenceId], references: [id], map: "trending_topic_hashtag_fkey")
  keyword Keyword? @relation(fields: [referenceId], references: [id], map: "trending_topic_keyword_fkey")

  @@index([type])
  @@index([trendScore])
  @@index([category])
  @@index([region])
  @@index([detectedAt])
  @@index([isActive])
  @@index([velocity])
  @@map("trending_topics")
}

enum TrendType {
  HASHTAG
  KEYWORD
  TOPIC
  USER
  POST
}

// ========================================
// ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª - Notifications
// ========================================

model Notification {
  id       String           @id @default(uuid())
  userId   String           @map("user_id")
  type     NotificationType
  title    String
  message  String
  dataJson String?          @map("data_json") // Additional data as JSON

  // Action and navigation
  actionUrl  String? @map("action_url")
  actionType String? @map("action_type")

  // Status
  isRead   Boolean              @default(false) @map("is_read")
  readAt   DateTime?            @map("read_at")
  priority NotificationPriority @default(NORMAL)

  // Delivery
  isSent         Boolean   @default(false) @map("is_sent")
  sentAt         DateTime? @map("sent_at")
  deliveryMethod String?   @map("delivery_method") // web, email, push

  // Expiration
  expiresAt DateTime? @map("expires_at")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([type])
  @@index([isRead])
  @@index([priority])
  @@index([createdAt])
  @@index([expiresAt])
  @@index([isSent])
  @@map("notifications")
}

enum NotificationType {
  LIKE
  COMMENT
  SHARE
  FOLLOW
  NOMINATION
  MESSAGE
  MENTION
  SYSTEM
  SECURITY
  PROMOTION
  TREND
  ACHIEVEMENT
  BESTFRIEND
}

enum NotificationPriority {
  LOW
  NORMAL
  HIGH
  URGENT
}

// ========================================
// ğŸš¨ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª - Reports & Violations
// ========================================

model Report {
  id          String           @id @default(uuid())
  reporterId  String           @map("reporter_id")
  targetType  ReportTargetType @map("target_type")
  targetId    String           @map("target_id")
  reason      ReportReason
  description String?

  // Evidence
  evidence    String[] // URLs to evidence files
  screenshots String[] // Screenshot URLs

  // Status and processing
  status   ReportStatus   @default(PENDING)
  priority ReportPriority @default(NORMAL)
  severity ReportSeverity @default(LOW)

  // Review information
  reviewedBy  String?       @map("reviewed_by")
  reviewedAt  DateTime?     @map("reviewed_at")
  reviewNotes String?       @map("review_notes")
  action      ReportAction?

  // Additional tracking
  category    String?
  tags        String[]
  isAnonymous Boolean  @default(false) @map("is_anonymous")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  reporter User   @relation("Reporter", fields: [reporterId], references: [id])
  reviewer User?  @relation("Reviewer", fields: [reviewedBy], references: [id], map: "report_reviewer_fkey")
  admin    Admin? @relation(fields: [reviewedBy], references: [userId], map: "report_admin_fkey")

  // Target relations (polymorphic)
  post        Post?        @relation(fields: [targetId], references: [id], map: "report_post_fkey")
  interaction Interaction? @relation(fields: [targetId], references: [id], map: "report_interaction_fkey")
  video       Video?       @relation(fields: [targetId], references: [id], map: "report_video_fkey")
  message     Message?     @relation(fields: [targetId], references: [id], map: "report_message_fkey")

  @@index([reporterId])
  @@index([targetType, targetId])
  @@index([status])
  @@index([priority])
  @@index([severity])
  @@index([reviewedBy])
  @@index([createdAt])
  @@index([reason])
  @@map("reports")
}

enum ReportTargetType {
  POST
  COMMENT
  USER
  VIDEO
  MESSAGE
  CHANNEL
  PLAYLIST
}

enum ReportReason {
  SPAM
  HARASSMENT
  HATE_SPEECH
  VIOLENCE
  INAPPROPRIATE_CONTENT
  COPYRIGHT
  FAKE_NEWS
  IMPERSONATION
  PRIVACY_VIOLATION
  NUDITY
  TERRORISM
  DRUGS
  SELF_HARM
  OTHER
}

enum ReportStatus {
  PENDING
  UNDER_REVIEW
  RESOLVED
  DISMISSED
  ESCALATED
  ARCHIVED
}

enum ReportPriority {
  LOW
  NORMAL
  HIGH
  CRITICAL
}

enum ReportSeverity {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum ReportAction {
  WARNING
  CONTENT_REMOVED
  CONTENT_HIDDEN
  ACCOUNT_SUSPENDED
  ACCOUNT_BANNED
  NO_ACTION
  REFERRED_TO_AUTHORITIES
}

// ========================================
// ğŸš« Ø§Ù„Ø­Ø¸Ø± Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† - User Blocks
// ========================================

model UserBlock {
  id            String    @id @default(uuid())
  blockerUserId String    @map("blocker_user_id")
  blockedUserId String    @map("blocked_user_id")
  reason        String?
  blockType     BlockType @default(FULL_BLOCK) @map("block_type")

  // Status
  isActive Boolean @default(true) @map("is_active")

  // Duration (for temporary blocks)
  expiresAt DateTime? @map("expires_at")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  blocker User @relation("Blocker", fields: [blockerUserId], references: [id], onDelete: Cascade)
  blocked User @relation("Blocked", fields: [blockedUserId], references: [id], onDelete: Cascade)

  @@unique([blockerUserId, blockedUserId])
  @@index([blockerUserId])
  @@index([blockedUserId])
  @@index([isActive])
  @@index([blockType])
  @@index([expiresAt])
  @@map("user_blocks")
}

enum BlockType {
  FULL_BLOCK // Complete block
  MESSAGES_ONLY // Block messages only
  POSTS_ONLY // Block posts only
  TEMPORARY // Temporary block
}

// ========================================
// ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø· - Activity Logs
// ========================================

model ActivityLog {
  id          String         @id @default(uuid())
  userId      String         @map("user_id")
  action      ActivityAction
  targetType  String?        @map("target_type")
  targetId    String?        @map("target_id")
  description String

  // Additional context
  metadata String? // JSON metadata
  category ActivityCategory?

  // Request information
  ipAddress  String?     @map("ip_address")
  userAgent  String?     @map("user_agent")
  deviceType DeviceType? @map("device_type")

  // Geolocation
  country String?
  region  String?
  city    String?

  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([action])
  @@index([targetType, targetId])
  @@index([createdAt])
  @@index([category])
  @@index([ipAddress])
  @@map("activity_logs")
}

enum ActivityAction {
  // Authentication
  LOGIN
  LOGOUT
  REGISTER
  PASSWORD_CHANGE

  // Content actions
  CREATE_POST
  EDIT_POST
  DELETE_POST
  LIKE_POST
  UNLIKE_POST
  COMMENT_POST
  SHARE_POST
  SAVE_POST

  // Social actions
  FOLLOW_USER
  UNFOLLOW_USER
  BLOCK_USER
  UNBLOCK_USER

  // Reporting
  REPORT_CONTENT
  REVIEW_REPORT

  // Profile actions
  UPDATE_PROFILE
  UPLOAD_AVATAR
  UPDATE_SETTINGS

  // Video actions
  UPLOAD_VIDEO
  DELETE_VIDEO
  CREATE_PLAYLIST

  // Messaging
  JOIN_CONVERSATION
  LEAVE_CONVERSATION
  SEND_MESSAGE
  DELETE_MESSAGE

  // Nominations
  NOMINATE_USER
  ACCEPT_NOMINATION
  REJECT_NOMINATION

  // Admin actions
  BAN_USER
  UNBAN_USER
  DELETE_CONTENT
  APPROVE_CONTENT
}

enum ActivityCategory {
  AUTHENTICATION
  CONTENT
  SOCIAL
  ADMIN
  SECURITY
  MESSAGING
  VIDEO
}

// ========================================
// ğŸ¯ Ù…Ù„Ù Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ - Auto-Generated User Interest Profile
// ========================================

model UserInterestProfile {
  id     String @id @default(uuid())
  userId String @unique @map("user_id")

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
  profileVersion    Int      @default(1) @map("profile_version")
  lastCalculated    DateTime @default(now()) @map("last_calculated")
  nextUpdateDue     DateTime @map("next_update_due")
  calculationMethod String   @default("behavioral_analysis_v1") @map("calculation_method")

  // Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø«Ù‚Ø© ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©
  overallConfidence   Float @default(0.5) @map("overall_confidence") // 0-1
  dataQuality         Float @default(0.5) @map("data_quality") // 0-1
  profileCompleteness Float @default(0.0) @map("profile_completeness") // 0-1

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ù„ÙˆÙƒ
  totalInteractions  Int      @default(0) @map("total_interactions")
  uniqueInterests    Int      @default(0) @map("unique_interests")
  dominantCategories String[] @map("dominant_categories") // Top 5 categories

  // Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  topInterests       Json @map("top_interests") // Top 20 interests with scores
  interestCategories Json @map("interest_categories") // Categories with aggregated scores
  interestTrends     Json @map("interest_trends") // Trending up/down interests

  // ØªØ­Ù„ÙŠÙ„ Ø´Ø®ØµÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  behaviorPattern   BehaviorPattern   @default(BALANCED) @map("behavior_pattern")
  engagementStyle   EngagementStyle   @default(CASUAL) @map("engagement_style")
  contentPreference ContentPreference @default(MIXED) @map("content_preference")

  // ØªØ®ØµÙŠØµ Ø§Ù„ØªØ¬Ø±Ø¨Ø©
  recommendationWeight Float @default(1.0) @map("recommendation_weight")
  exploreVsExploit     Float @default(0.7) @map("explore_vs_exploit") // 0=exploit, 1=explore
  diversityScore       Float @default(0.5) @map("diversity_score")

  // ØªØªØ¨Ø¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
  significantChanges Json? @map("significant_changes") // Major interest changes
  stabilityScore     Float @default(0.5) @map("stability_score") // How stable interests are

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«
  updateFrequency   UpdateFrequency @default(WEEKLY) @map("update_frequency")
  autoUpdateEnabled Boolean         @default(true) @map("auto_update_enabled")
  manualOverrides   Json?           @map("manual_overrides") // User manual adjustments

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([lastCalculated])
  @@index([nextUpdateDue])
  @@index([overallConfidence])
  @@index([profileCompleteness])
  @@index([behaviorPattern])
  @@index([autoUpdateEnabled])
  @@map("user_interest_profiles")
}

model UserInterestScore {
  id           String @id @default(uuid())
  userId       String @map("user_id")
  interestName String @map("interest_name")

  // Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…
  currentScore    Float @map("current_score") // 0-100 main score
  rawScore        Float @map("raw_score") // Before normalization
  normalizedScore Float @map("normalized_score") // 0-1 normalized
  weightedScore   Float @map("weighted_score") // With time decay and boosts

  // ØªØµÙ†ÙŠÙ Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…
  category    String
  subcategory String?
  keywords    String[] // Related keywords
  confidence  Float    @default(0.5) // Confidence in this interest

  // Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…
  sources       String[] @map("sources") // Multiple sources as strings
  sourceWeights Json     @map("source_weights") // Weight per source
  primarySource String   @map("primary_source") // Primary source as string

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙØ§Ø¹Ù„
  totalInteractions  Int    @default(0) @map("total_interactions")
  recentInteractions Int    @default(0) @map("recent_interactions") // Last 30 days
  avgInteractionGap  Float? @map("avg_interaction_gap") // Days between interactions

  // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø²Ù…Ù†ÙŠ
  firstDetected DateTime @default(now()) @map("first_detected")
  lastActivity  DateTime @default(now()) @map("last_activity")
  peakPeriod    String?  @map("peak_period") // When most active
  seasonality   Float? // Seasonal interest pattern

  // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª
  trendDirection TrendDirection @default(STABLE) @map("trend_direction")
  trendStrength  Float          @default(0) @map("trend_strength") // -1 to 1
  momentum       Float          @default(0) // Recent change velocity
  volatility     Float          @default(0) // How stable the interest is

  // Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
  decayFactor      Float @default(0.98) @map("decay_factor")
  boostFactor      Float @default(1.0) @map("boost_factor")
  contextualWeight Float @default(1.0) @map("contextual_weight")

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…
  status     InterestStatus @default(ACTIVE)
  isCore     Boolean        @default(false) @map("is_core") // Core/persistent interest
  isEmerging Boolean        @default(false) @map("is_emerging") // New interest
  isFading   Boolean        @default(false) @map("is_fading") // Declining interest

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  relatedPosts    String[] @map("related_posts") // Post IDs that contributed
  relatedUsers    String[] @map("related_users") // Users associated with this interest
  relatedHashtags String[] @map("related_hashtags")

  lastCalculated     DateTime  @default(now()) @map("last_calculated")
  nextReview         DateTime? @map("next_review")
  lastDecayApplied   DateTime? @map("last_decay_applied") // Ø¢Ø®Ø± ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
  needsRecalculation Boolean   @default(false) @map("needs_recalculation")
  isArchived         Boolean   @default(false) @map("is_archived") // Ù…Ø¤Ø±Ø´Ù Ù„Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, interestName])
  @@index([userId])
  @@index([interestName])
  @@index([category])
  @@index([currentScore])
  @@index([confidence])
  @@index([status])
  @@index([isCore])
  @@index([isEmerging])
  @@index([isFading])
  @@index([lastActivity])
  @@index([trendDirection])
  @@index([category, currentScore])
  @@map("user_interest_scores")
}

// Enums for Interest System
enum BehaviorPattern {
  FOCUSED // Focused on few interests
  DIVERSE // Wide range of interests  
  EXPLORER // Constantly discovering new interests
  CONSISTENT // Stable, unchanging interests
  SEASONAL // Interests change with seasons/time
  BALANCED // Mix of focused and diverse
}

enum EngagementStyle {
  PASSIVE // Mostly viewing/consuming
  ACTIVE // Regular commenting/sharing
  CREATOR // Creates content regularly
  CURATOR // Saves and organizes content
  SOCIAL // Focus on social interactions
  CASUAL // Light, occasional engagement
}

enum ContentPreference {
  TEXT_HEAVY // Prefers text content
  VISUAL // Prefers images/videos
  MIXED // No strong preference
  INTERACTIVE // Prefers interactive content
  SHORT_FORM // Quick, bite-sized content
  LONG_FORM // In-depth, detailed content
}

enum UpdateFrequency {
  DAILY
  WEEKLY
  BIWEEKLY
  MONTHLY
  QUARTERLY
  ON_DEMAND // Only when manually triggered
}

enum InterestStatus {
  ACTIVE // Currently active interest
  DORMANT // Temporarily inactive
  EMERGING // New, growing interest
  FADING // Declining interest
  ARCHIVED // Historical interest
  SUPPRESSED // Manually suppressed by user
}

enum TrendDirection {
  RISING // Interest is growing
  STABLE // Interest is stable
  DECLINING // Interest is declining
  VOLATILE // Interest fluctuates
  SEASONAL // Interest follows seasonal pattern
}

enum InterestSource {
  INTERACTION // From post interactions
  PROFILE // From profile information
  SEARCH // From search behavior
  VIEWING_TIME // From time spent on content
  EXPLICIT // Explicitly selected by user
  HASHTAG // From hashtag usage
  FOLLOWING // From following patterns
  SAVE // From saved content
  SHARE // From shared content
  COMMENT // From comments
  LIKE // From likes
  RECOMMENDATION // From AI recommendations
  TRENDING // From trending content engagement
}

// ========================================
// ğŸ¯ Content Classification & Sentiment Analysis
// ========================================

model ContentCategory {
  id          String  @id @default(uuid())
  name        String  @unique // Ù…Ø«Ù„: ØªÙ‚Ù†ÙŠØŒ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØŒ ØµØ­ÙŠØŒ Ø±ÙŠØ§Ø¶ÙŠ...
  nameAr      String // Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
  nameEn      String // Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
  description String? // ÙˆØµÙ Ø§Ù„ÙØ¦Ø©
  color       String? // Ù„ÙˆÙ† Ù…Ù…ÙŠØ² Ù„Ù„ÙØ¦Ø© ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
  icon        String? // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙØ¦Ø©

  // Hierarchy support - Ù„Ù„ÙØ¦Ø§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ©
  parentId String?           @map("parent_id")
  parent   ContentCategory?  @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children ContentCategory[] @relation("CategoryHierarchy")

  // Configuration
  isActive         Boolean @default(true) @map("is_active")
  requiresApproval Boolean @default(false) @map("requires_approval") // Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ø´Ø±Ù
  isSensitive      Boolean @default(false) @map("is_sensitive") // Ù…Ø­ØªÙˆÙ‰ Ø­Ø³Ø§Ø³

  // Stats
  postsCount Int @default(0) @map("posts_count")
  priority   Int @default(0) // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø±Ø¶

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  postClassifications      PostClassification[] @relation("PrimaryCategory")
  secondaryClassifications PostClassification[] @relation("SecondaryCategory")
  moderationRules          ModerationRule[]

  @@index([name])
  @@index([parentId])
  @@index([isActive])
  @@index([priority])
  @@map("content_categories")
}

model PostClassification {
  id     String @id @default(uuid())
  postId String @map("post_id")

  // Primary Classification
  primaryCategoryId   String  @map("primary_category_id")
  secondaryCategoryId String? @map("secondary_category_id")

  // Confidence & Quality
  confidence   Float  @default(0.0) // 0.0 - 1.0
  qualityScore Float? @map("quality_score") // ØªÙ‚ÙŠÙŠÙ… Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰

  // AI Analysis
  aiKeywords   String[] // ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ù…Ø³ØªØ®Ø±Ø¬Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  aiTopics     String[] // Ù…ÙˆØ§Ø¶ÙŠØ¹ Ù…Ø­Ø¯Ø¯Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  languageCode String   @default("ar") @map("language_code") // ar, en, etc.

  // Manual Override
  manualOverride Boolean   @default(false) @map("manual_override")
  reviewedBy     String?   @map("reviewed_by") // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø°ÙŠ Ø±Ø§Ø¬Ø¹
  reviewedAt     DateTime? @map("reviewed_at")
  reviewNotes    String?   @map("review_notes")

  // Status
  isApproved  Boolean @default(true) @map("is_approved")
  needsReview Boolean @default(false) @map("needs_review")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  post              Post                    @relation(fields: [postId], references: [id], onDelete: Cascade)
  primaryCategory   ContentCategory         @relation("PrimaryCategory", fields: [primaryCategoryId], references: [id])
  secondaryCategory ContentCategory?        @relation("SecondaryCategory", fields: [secondaryCategoryId], references: [id])
  sentimentAnalyses PostSentimentAnalysis[] // Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ

  @@unique([postId]) // ÙƒÙ„ Ù…Ù†Ø´ÙˆØ± Ù„Ù‡ ØªØµÙ†ÙŠÙ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
  @@index([primaryCategoryId])
  @@index([confidence])
  @@index([isApproved])
  @@index([needsReview])
  @@index([languageCode])
  @@map("post_classifications")
}

model PostSentimentAnalysis {
  id                   String @id @default(uuid())
  postClassificationId String @unique @map("post_classification_id")

  // Overall Sentiment
  sentimentScore Float @default(0.0) // -1.0 (Ø³Ù„Ø¨ÙŠ Ø¬Ø¯Ø§Ù‹) Ø¥Ù„Ù‰ +1.0 (Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ø¬Ø¯Ø§Ù‹)
  confidence     Float @default(0.0) // Ø«Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ 0.0 - 1.0

  // Detailed Analysis
  positiveScore Float @default(0.0) @map("positive_score") // 0.0 - 1.0
  negativeScore Float @default(0.0) @map("negative_score") // 0.0 - 1.0
  neutralScore  Float @default(0.0) @map("neutral_score") // 0.0 - 1.0

  // Context Analysis
  toxicityScore Float @default(0.0) @map("toxicity_score") // 0.0 - 1.0
  hateScore     Float @default(0.0) @map("hate_score") // ÙƒØ±Ø§Ù‡ÙŠØ©
  threatsScore  Float @default(0.0) @map("threats_score") // ØªÙ‡Ø¯ÙŠØ¯Ø§Øª
  spamScore     Float @default(0.0) @map("spam_score") // Ø³Ø¨Ø§Ù…

  // Keywords & Triggers
  positiveKeywords String[] @map("positive_keywords")
  negativeKeywords String[] @map("negative_keywords")
  triggerWords     String[] @map("trigger_words") // ÙƒÙ„Ù…Ø§Øª Ù‚Ø¯ ØªØ³Ø¨Ø¨ Ù…Ø´Ø§ÙƒÙ„

  // Manual Review
  manualReview   Boolean   @default(false) @map("manual_review")
  reviewerUserId String?   @map("reviewer_user_id")
  reviewerNotes  String?   @map("reviewer_notes")
  reviewedAt     DateTime? @map("reviewed_at")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  postClassification PostClassification @relation(fields: [postClassificationId], references: [id], onDelete: Cascade)

  @@index([sentimentScore])
  @@index([toxicityScore])
  @@map("post_sentiment_analysis")
}

model ModerationRule {
  id         String @id @default(uuid())
  categoryId String @map("category_id")

  // Rule Definition
  name        String // Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
  description String // ÙˆØµÙ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©

  // Conditions
  keywords     String[] // ÙƒÙ„Ù…Ø§Øª Ù…Ø­Ø¸ÙˆØ±Ø© Ø£Ùˆ Ù…Ø´Ø¨ÙˆÙ‡Ø©
  sentimentMin Float?   @map("sentiment_min") // Ø£Ù‚Ù„ Ø¯Ø±Ø¬Ø© Ù…Ø´Ø§Ø¹Ø± Ù…Ù‚Ø¨ÙˆÙ„Ø©
  sentimentMax Float?   @map("sentiment_max") // Ø£Ø¹Ù„Ù‰ Ø¯Ø±Ø¬Ø© Ù…Ø´Ø§Ø¹Ø± Ù…Ù‚Ø¨ÙˆÙ„Ø©
  toxicityMax  Float?   @map("toxicity_max") // Ø£Ù‚ØµÙ‰ Ù…Ø³ØªÙˆÙ‰ Ø³Ù…ÙŠØ© Ù…Ù‚Ø¨ÙˆÙ„

  // Actions
  autoExecute   Boolean @default(false) @map("auto_execute") // ØªÙ†ÙÙŠØ° ØªÙ„Ù‚Ø§Ø¦ÙŠ
  requiresHuman Boolean @default(true) @map("requires_human") // ÙŠØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨Ø´Ø±ÙŠØ©

  // Configuration
  isActive Boolean @default(true) @map("is_active")
  priority Int     @default(0) // Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  category ContentCategory @relation(fields: [categoryId], references: [id])

  @@index([categoryId])
  @@index([isActive])
  @@index([priority])
  @@map("moderation_rules")
}

model ContentModerationLog {
  id     String @id @default(uuid())
  postId String @map("post_id")

  // Action Details
  reason String // Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
  ruleId String? @map("rule_id") // Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§

  // Execution
  executedBy  String? @map("executed_by") // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø´Ø±Ù Ø£Ùˆ "system"
  isAutomatic Boolean @default(false) @map("is_automatic")

  // Before/After State
  beforeStatus String? @map("before_status")
  afterStatus  String? @map("after_status")

  // Additional Data
  metadata Json? // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  notes    String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø´Ø±Ù

  createdAt DateTime @default(now()) @map("created_at")

  @@index([postId])
  @@index([executedBy])
  @@index([isAutomatic])
  @@index([createdAt])
  @@map("content_moderation_logs")
}

// ========================================
// ğŸ“Š Content Analytics & Insights
// ========================================

// Ø¬Ø¯ÙˆÙ„ ØªØ­Ù„ÙŠÙ„ Ø¬Ø§Ø°Ø¨ÙŠØ© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ©
model PostAttractiveness {
  id     String @id @default(uuid())
  postId String @unique @map("post_id")

  // Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
  overallScore   Float @default(0.0) @map("overall_score") // 0-100 Ù†Ù‚Ø§Ø· Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
  visualAppeal   Float @default(0.0) @map("visual_appeal") // Ø¬Ø§Ø°Ø¨ÙŠØ© Ø¨ØµØ±ÙŠØ© (Ù„Ù„ØµÙˆØ±/ÙÙŠØ¯ÙŠÙˆ)
  contentQuality Float @default(0.0) @map("content_quality") // Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  engagement     Float @default(0.0) @map("engagement") // Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„
  virality       Float @default(0.0) @map("virality") // Ø§Ù„Ù‚Ø§Ø¨Ù„ÙŠØ© Ù„Ù„Ø§Ù†ØªØ´Ø§Ø±

  // ØªØ­Ù„ÙŠÙ„ Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙØ§Ø¹Ù„
  initialResponse     Float     @default(0.0) @map("initial_response") // Ø§Ù„ØªÙØ§Ø¹Ù„ ÙÙŠ Ø£ÙˆÙ„ Ø³Ø§Ø¹Ø©
  peakTime            DateTime? @map("peak_time") // ÙˆÙ‚Øª Ø°Ø±ÙˆØ© Ø§Ù„ØªÙØ§Ø¹Ù„
  sustainabilityScore Float     @default(0.0) @map("sustainability_score") // Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø§Ù„ØªÙØ§Ø¹Ù„

  // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±
  audienceMatch     Float @default(0.0) @map("audience_match") // Ù…Ø·Ø§Ø¨Ù‚Ø© Ù…Ø¹ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±
  demographicAppeal Json? @map("demographic_appeal") // Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ù„Ù„ÙØ¦Ø§Øª Ø§Ù„Ø¹Ù…Ø±ÙŠØ©/Ø§Ù„Ø¬Ù†Ø³
  geographicAppeal  Json? @map("geographic_appeal") // Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©

  // Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
  hasMedia    Boolean @default(false) @map("has_media") // ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙˆØ³Ø§Ø¦Ø·
  hasHashtags Boolean @default(false) @map("has_hashtags") // ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù‡Ø§Ø´ØªØ§Øº
  postLength  Int     @default(0) @map("post_length") // Ø·ÙˆÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
  postTiming  Float   @default(0.0) @map("post_timing") // ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù†Ø´Ø± (Ù…Ù‚ÙŠØ§Ø³ 0-1)

  // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  sentimentScore  Float @default(0.0) @map("sentiment_score") // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
  toxicityScore   Float @default(0.0) @map("toxicity_score") // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ù…ÙŠØ©
  clarityScore    Float @default(0.0) @map("clarity_score") // ÙˆØ¶ÙˆØ­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  creativityScore Float @default(0.0) @map("creativity_score") // Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹

  // Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª
  trendAlignment Float @default(0.0) @map("trend_alignment") // Ù…Ø·Ø§Ø¨Ù‚Ø© Ù…Ø¹ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª
  seasonalFactor Float @default(1.0) @map("seasonal_factor") // Ø§Ù„Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙˆØ³Ù…ÙŠ

  // ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
  predictedViews  Int   @default(0) @map("predicted_views")
  predictedLikes  Int   @default(0) @map("predicted_likes")
  predictedShares Int   @default(0) @map("predicted_shares")
  confidenceLevel Float @default(0.5) @map("confidence_level") // Ø«Ù‚Ø© Ø§Ù„ØªÙˆÙ‚Ø¹

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«
  calculationMethod  String   @default("ai_analysis_v1") @map("calculation_method")
  lastCalculated     DateTime @default(now()) @map("last_calculated")
  needsRecalculation Boolean  @default(false) @map("needs_recalculation")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  post Post @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([overallScore])
  @@index([engagement])
  @@index([virality])
  @@index([lastCalculated])
  @@index([audienceMatch])
  @@index([trendAlignment])
  @@map("post_attractiveness")
}

// Ø¬Ø¯ÙˆÙ„ Ø±Ø¨Ø· Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨ØªØ­Ù„ÙŠÙ„ Ø§Ù‡ØªÙ…Ø§Ù…Ø§ØªÙ‡
model UserPostInterestMapping {
  id     String @id @default(uuid())
  userId String @map("user_id")
  postId String @map("post_id")

  // Ø±Ø¨Ø· Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª
  relatedInterests String[] @map("related_interests") // Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
  interestScores   Json     @map("interest_scores") // Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© {interest: score}
  categoryMatch    String?  @map("category_match") // Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©

  // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ·Ø§Ø¨Ù‚
  matchScore           Float @default(0.0) @map("match_score") // Ù…Ø³ØªÙˆÙ‰ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ù…Ø¹ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  personalRelevance    Float @default(0.0) @map("personal_relevance") // Ø§Ù„ØµÙ„Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
  discoverabilityScore Float @default(0.0) @map("discoverability_score") // Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„Ø§ÙƒØªØ´Ø§Ù

  // Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  viewTime            Int?                @map("view_time") // ÙˆÙ‚Øª Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  interactionDelay    Int?                @map("interaction_delay") // ØªØ£Ø®ÙŠØ± Ø§Ù„ØªÙØ§Ø¹Ù„ Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  engagementType      UserEngagementType? @map("engagement_type")
  engagementIntensity Float               @default(0.0) @map("engagement_intensity") // Ø´Ø¯Ø© Ø§Ù„ØªÙØ§Ø¹Ù„

  // ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª
  affectedInterests     String[] @map("affected_interests") // Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©
  interestWeightChanges Json?    @map("interest_weight_changes") // ØªØºÙŠÙŠØ±Ø§Øª Ø£ÙˆØ²Ø§Ù† Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª
  profileImpactScore    Float    @default(0.0) @map("profile_impact_score") // ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„
  analysisMethod String  @default("behavioral_analysis") @map("analysis_method")
  confidence     Float   @default(0.5) @map("confidence")
  needsUpdate    Boolean @default(false) @map("needs_update")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  post Post @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@unique([userId, postId])
  @@index([userId])
  @@index([postId])
  @@index([matchScore])
  @@index([personalRelevance])
  @@index([engagementType])
  @@index([createdAt])
  @@map("user_post_interest_mapping")
}

enum UserEngagementType {
  PASSIVE_VIEW // Ù…Ø´Ø§Ù‡Ø¯Ø© Ø³Ù„Ø¨ÙŠØ©
  ACTIVE_VIEW // Ù…Ø´Ø§Ù‡Ø¯Ø© Ù†Ø´Ø·Ø© (ÙˆÙ‚Øª Ø·ÙˆÙŠÙ„)
  LIKE // Ø¥Ø¹Ø¬Ø§Ø¨
  COMMENT // ØªØ¹Ù„ÙŠÙ‚
  SHARE // Ù…Ø´Ø§Ø±ÙƒØ©
  SAVE // Ø­ÙØ¸
  CLICK_PROFILE // Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
  CLICK_HASHTAG // Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ù‡Ø§Ø´ØªØ§Øº
  FULL_ENGAGEMENT // ØªÙØ§Ø¹Ù„ ÙƒØ§Ù…Ù„ (Ø£ÙƒØ«Ø± Ù…Ù† Ù†ÙˆØ¹)
}

model ContentInsight {
  id   String   @id @default(uuid())
  date DateTime @map("insight_date") // ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ù„ÙŠÙ„

  // Category Analysis
  categoryId    String @map("category_id")
  postsCount    Int    @default(0) @map("posts_count")
  viewsCount    Int    @default(0) @map("views_count")
  likesCount    Int    @default(0) @map("likes_count")
  commentsCount Int    @default(0) @map("comments_count")
  sharesCount   Int    @default(0) @map("shares_count")

  // Sentiment Statistics
  positiveCount Int   @default(0) @map("positive_count")
  negativeCount Int   @default(0) @map("negative_count")
  neutralCount  Int   @default(0) @map("neutral_count")
  avgSentiment  Float @default(0.0) @map("avg_sentiment")

  // Quality Metrics
  avgQualityScore  Float @default(0.0) @map("avg_quality_score")
  avgToxicityScore Float @default(0.0) @map("avg_toxicity_score")
  moderatedCount   Int   @default(0) @map("moderated_count")
  flaggedCount     Int   @default(0) @map("flagged_count")

  // Trending
  trendScore     Float @default(0.0) @map("trend_score")
  engagementRate Float @default(0.0) @map("engagement_rate")

  createdAt DateTime @default(now()) @map("created_at")

  @@unique([date, categoryId])
  @@index([date])
  @@index([categoryId])
  @@index([trendScore])
  @@map("content_insights")
}

// ğŸ’° Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ù…ÙˆÙ„Ø© - Sponsored Campaigns System
// ========================================

enum AdvertiserType {
  INDIVIDUAL
  BUSINESS
  AGENCY
}

enum CampaignType {
  BRAND_AWARENESS
  TRAFFIC
  ENGAGEMENT
  LEAD_GENERATION
  SALES
  VIDEO_VIEWS
  APP_INSTALL
  OTHER
}

enum CampaignGoal {
  IMPRESSIONS

  CLICKS
  CONVERSIONS
  REACH
  VIDEO_VIEWS
  ENGAGEMENT
  SALES
  OTHER
}

enum CampaignStatus {
  DRAFT
  ACTIVE
  PAUSED
  COMPLETED
  CANCELLED
  REJECTED
}

enum SponsoredStatus {
  DRAFT
  PENDING
  ACTIVE
  PAUSED
  COMPLETED
  CANCELLED
  REJECTED
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
  CANCELLED
}

enum TargetingStrategy {
  BROAD
  INTEREST
  DEMOGRAPHIC
  LOCATION
  CUSTOM_AUDIENCE
}

enum BidType {
  CPC
  CPM
  CPA
  CPV
}

enum BidStrategy {
  MANUAL
  AUTOMATIC
  TARGET_COST
}

enum PacingType {
  STANDARD
  ACCELERATED
}

enum ScheduleType {
  CONTINUOUS
  FIXED_DATES
}

enum TransactionType {
  CHARGE
  REFUND
  ADJUSTMENT
}

enum PaymentMethod {
  CREDIT_CARD
  BANK_TRANSFER
  WALLET
  PAYPAL
  OTHER
}

enum TransactionStatus {
  PENDING
  COMPLETED
  FAILED
  CANCELLED
}

enum PriorityLevel {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum SponsoredAdType {
  POST // Ø¥Ø¹Ù„Ø§Ù† Ù…Ø±ØªØ¨Ø· Ø¨Ù…Ù†Ø´ÙˆØ± Ø¹Ø§Ø¯ÙŠ
  VIDEO // Ø¥Ø¹Ù„Ø§Ù† Ù…Ø±ØªØ¨Ø· Ø¨ÙÙŠØ¯ÙŠÙˆ
  BANNER // Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø§Ù†Ø± Ù…Ø³ØªÙ‚Ù„
}

enum BannerPosition {
  TOP // Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
  BOTTOM // Ø£Ø³ÙÙ„ Ø§Ù„ØµÙØ­Ø©
  SIDEBAR // Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
  INLINE // Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  POPUP // Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©
  OVERLAY // Ø·Ø¨Ù‚Ø© Ø¹Ù„ÙˆÙŠØ©
}

model Campaign {
  id             String         @id @default(uuid())
  name           String
  description    String?
  advertiserId   String
  advertiserType AdvertiserType @default(INDIVIDUAL)
  type           CampaignType
  goal           CampaignGoal
  status         CampaignStatus @default(DRAFT)
  budget         Float
  dailyBudget    Float?
  startDate      DateTime
  endDate        DateTime
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt

  // Relations
  sponsoredAds SponsoredAd[]
  targetings   SponsoredTargeting[]
  performance  SponsoredPerformance[]
  transactions SponsoredTransaction[]
  // invoices     SponsoredAdInvoice[]   @relation("CampaignInvoices") // Ù…ÙØ¹Ø·Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹
  advertiser   User                   @relation(fields: [advertiserId], references: [id])
}

model SponsoredAd {
  id           String          @id @default(uuid())
  campaignId   String
  type         SponsoredAdType
  title        String
  content      String?
  mediaUrl     String?
  targetUrl    String?
  status       SponsoredStatus @default(DRAFT)
  impressions  Int             @default(0)
  clicks       Int             @default(0)
  cost         Float           @default(0)
  bidType      BidType         @default(CPC)
  bidAmount    Float           @default(0)
  bidStrategy  BidStrategy     @default(AUTOMATIC)
  pacingType   PacingType      @default(STANDARD)
  scheduleType ScheduleType    @default(CONTINUOUS)
  priority     PriorityLevel   @default(MEDIUM)
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @default(now()) @map("updated_at")

  // Relations
  campaign        Campaign               @relation(fields: [campaignId], references: [id])
  bids            SponsoredBid[]
  insights        SponsoredInsight[]
  performance     SponsoredPerformance[]
  targetings      SponsoredTargeting[]
  sponsoredPost   SponsoredPost?
  sponsoredVideo  SponsoredVideo?
  sponsoredBanner SponsoredBanner?
}

model SponsoredTargeting {
  id             String            @id @default(uuid())
  campaignId     String            @map("campaign_id")
  sponsoredAdId  String            @map("sponsored_ad_id")
  strategy       TargetingStrategy @default(BROAD)
  ageMin         Int?
  ageMax         Int?
  genders        String[]
  locations      String[]
  interests      String[]
  customAudience Json?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @default(now()) @map("updated_at")

  // Relations
  campaign    Campaign              @relation(fields: [campaignId], references: [id])
  sponsoredAd SponsoredAd           @relation(fields: [sponsoredAdId], references: [id])
  userTargets SponsoredUserTarget[]

  @@index([campaignId])
  @@index([sponsoredAdId])
  @@map("sponsored_targeting")
}

model SponsoredUserTarget {
  id           String   @id @default(uuid())
  targetingId  String
  userId       String
  matchedScore Float    @default(0)
  isReached    Boolean  @default(false)
  isClicked    Boolean  @default(false)
  createdAt    DateTime @default(now())

  // Relations
  targeting SponsoredTargeting @relation(fields: [targetingId], references: [id])
  user      User               @relation(fields: [userId], references: [id])
}

model SponsoredPerformance {
  id            String   @id @default(uuid())
  campaignId    String
  sponsoredAdId String
  date          DateTime
  impressions   Int      @default(0)
  clicks        Int      @default(0)
  ctr           Float    @default(0)
  conversions   Int      @default(0)
  spend         Float    @default(0)
  cpc           Float    @default(0)
  cpm           Float    @default(0)
  cpa           Float    @default(0)
  cpv           Float    @default(0)
  createdAt     DateTime @default(now())

  // Relations
  campaign    Campaign    @relation(fields: [campaignId], references: [id])
  sponsoredAd SponsoredAd @relation(fields: [sponsoredAdId], references: [id])
}

model SponsoredBid {
  id            String          @id @default(uuid())
  sponsoredAdId String
  bidType       BidType         @default(CPC)
  amount        Float           @default(0)
  strategy      BidStrategy     @default(AUTOMATIC)
  status        SponsoredStatus @default(DRAFT)
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @default(now()) @map("updated_at")

  // Relations
  sponsoredAd SponsoredAd @relation(fields: [sponsoredAdId], references: [id])
}

model SponsoredInsight {
  id            String   @id @default(uuid())
  sponsoredAdId String
  date          DateTime
  impressions   Int      @default(0)
  clicks        Int      @default(0)
  ctr           Float    @default(0)
  conversions   Int      @default(0)
  spend         Float    @default(0)
  reach         Int      @default(0)
  frequency     Float    @default(0)
  avgViewTime   Float    @default(0)
  engagement    Int      @default(0)
  createdAt     DateTime @default(now())

  // Relations
  sponsoredAd SponsoredAd @relation(fields: [sponsoredAdId], references: [id])
}

// Ù†Ù…ÙˆØ°Ø¬ Ø±Ø¨Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ù…ÙˆÙ„ Ø¨Ù…Ù†Ø´ÙˆØ± Ø¹Ø§Ø¯ÙŠ
model SponsoredPost {
  id            String @id @default(uuid())
  sponsoredAdId String @unique @map("sponsored_ad_id")
  postId        String @map("post_id")

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ±ÙˆÙŠØ¬
  isPromoted     Boolean   @default(true) @map("is_promoted")
  promotionStart DateTime? @map("promotion_start")
  promotionEnd   DateTime? @map("promotion_end")

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ«
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  sponsoredAd SponsoredAd @relation(fields: [sponsoredAdId], references: [id], onDelete: Cascade)
  post        Post        @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([sponsoredAdId])
  @@index([postId])
  @@index([isPromoted])
  @@map("sponsored_posts")
}

// Ù†Ù…ÙˆØ°Ø¬ Ø±Ø¨Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ù…ÙˆÙ„ Ø¨ÙÙŠØ¯ÙŠÙˆ
model SponsoredVideo {
  id            String @id @default(uuid())
  sponsoredAdId String @unique @map("sponsored_ad_id")
  videoId       String @map("video_id")

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ù…ÙˆÙ„
  skipableAfter Int?    @map("skipable_after") // Ø«ÙˆØ§Ù†ÙŠ Ù‚Ø¨Ù„ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ®Ø·ÙŠ
  maxDuration   Int?    @map("max_duration") // Ø£Ù‚ØµÙ‰ Ù…Ø¯Ø© Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  autoPlay      Boolean @default(false) @map("auto_play")

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ«
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  sponsoredAd SponsoredAd @relation(fields: [sponsoredAdId], references: [id], onDelete: Cascade)
  video       Video       @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@index([sponsoredAdId])
  @@index([videoId])
  @@index([autoPlay])
  @@map("sponsored_videos")
}

// Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¨Ø§Ù†Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ù„
model SponsoredBanner {
  id            String @id @default(uuid())
  sponsoredAdId String @unique

  // Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø§Ù†Ø±
  imageUrl String  @map("image_url")
  linkUrl  String? @map("link_url") // Ø§Ù„Ø±Ø§Ø¨Ø· Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
  altText  String? @map("alt_text") // Ù†Øµ Ø¨Ø¯ÙŠÙ„ Ù„Ù„ØµÙˆØ±Ø©

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø±Ø¶
  width    Int? // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ù†Ø± Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„
  height   Int? // Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø¨Ø§Ù†Ø± Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„
  position BannerPosition @default(TOP) // Ù…ÙˆÙ‚Ø¹ Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ù†Ø±

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„
  openInNewTab Boolean @default(true) @map("open_in_new_tab")

  trackClicks Boolean @default(true) @map("track_clicks")

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ«
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  sponsoredAd SponsoredAd @relation(fields: [sponsoredAdId], references: [id], onDelete: Cascade)

  @@index([sponsoredAdId])
  @@index([position])
  @@map("sponsored_banners")
}

// Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©
model SponsoredTransaction {
  id            String            @id @default(uuid())
  campaignId    String            @map("campaign_id")
  amount        Float             @default(0)
  type          TransactionType   @default(CHARGE)
  method        PaymentMethod     @default(CREDIT_CARD)
  status        TransactionStatus @default(PENDING)
  paymentStatus PaymentStatus     @default(PENDING)
  reference     String?
  createdAt     DateTime          @default(now()) @map("created_at")
  updatedAt     DateTime          @default(now()) @map("updated_at")

  // Relations
  campaign Campaign @relation(fields: [campaignId], references: [id])

  @@index([campaignId])
  @@index([status])
  @@index([paymentStatus])
  @@index([type])
  @@map("sponsored_transactions")
}

// ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª ÙˆÙ…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© - Referral Audit & Anti-Fake Accounts System
model ReferralAuditLog {
  id                String  @id @default(uuid())
  referredUserId    String  @map("referred_user_id")
  referrerId        String  @map("referrer_id")
  ipAddress         String  @map("ip_address")
  deviceFingerprint String  @map("device_fingerprint")
  userAgent         String? @map("user_agent")
  geoLocation       String? @map("geo_location")

  // Verification status
  isVerified       Boolean @default(false) @map("is_verified")
  phoneVerified    Boolean @default(false) @map("phone_verified")
  behaviorVerified Boolean @default(false) @map("behavior_verified")

  // Fake detection
  fakeScore         Float    @default(0) @map("fake_score") // 0.0 = real, 1.0 = fake
  suspiciousFactors String[] @map("suspicious_factors") // Reasons for suspicion

  // Reward management
  rewardGranted Boolean @default(false) @map("reward_granted")
  rewardAmount  Float?  @map("reward_amount")
  rewardType    String? @map("reward_type") // 'points', 'money', 'bonus'

  // Activity tracking
  userFirstAction   DateTime? @map("user_first_action") // First meaningful action by referred user
  activeDays        Int       @default(0) @map("active_days") // Days user remained active
  totalInteractions Int       @default(0) @map("total_interactions") // Posts, comments, likes, etc.

  // Review process
  reviewStatus String    @default("pending") @map("review_status") // pending, approved, rejected, manual_review
  reviewedBy   String?   @map("reviewed_by") // Admin who reviewed
  reviewedAt   DateTime? @map("reviewed_at")
  reviewNotes  String?   @map("review_notes")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  referredUser User @relation("ReferralAuditLogs", fields: [referredUserId], references: [id], onDelete: Cascade)
  referrer     User @relation("ReferrerAuditLogs", fields: [referrerId], references: [id], onDelete: Cascade)

  @@index([referrerId])
  @@index([ipAddress])
  @@index([deviceFingerprint])
  @@index([fakeScore])
  @@index([reviewStatus])
  @@index([rewardGranted])
  @@index([createdAt])
  @@map("referral_audit_logs")
}

// ===============================
// ğŸ¥ Ø¬Ø¯Ø§ÙˆÙ„ ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
// ===============================

model VideoViewSession {
  id     String @id @default(uuid())
  userId String @map("user_id")
  postId String @map("post_id")

  // Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
  startTime     DateTime  @map("start_time")
  endTime       DateTime? @map("end_time")
  watchDuration Int       @map("watch_duration") // Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  isCompleted   Boolean   @default(false) @map("is_completed")
  dropOffTime   Int?      @map("drop_off_time") // ÙˆÙ‚Øª Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
  deviceType      DeviceType @map("device_type")
  qualitySettings String?    @map("quality_settings")
  isRewatch       Boolean    @default(false) @map("is_rewatch")

  // IP ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  ipAddress String? @map("ip_address")
  userAgent String? @map("user_agent")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  post Post @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([postId])
  @@index([startTime])
  @@index([isCompleted])
  @@index([deviceType])
  @@map("video_view_sessions")
}

model VideoMetrics {
  id     String @id @default(uuid())
  postId String @unique @map("post_id")

  // Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  totalViews       Int   @default(0) @map("total_views")
  totalWatchTime   Int   @default(0) @map("total_watch_time") // Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  averageWatchTime Float @default(0) @map("average_watch_time")
  completionRate   Float @default(0) @map("completion_rate") // Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„
  retentionRate    Float @default(0) @map("retention_rate") // Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸

  // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙØ§Ø¹Ù„
  engagementRate  Float @default(0) @map("engagement_rate")
  dropOffPoints   Int[] @map("drop_off_points") // Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹
  peakViewingTime Int   @default(0) @map("peak_viewing_time") // ÙˆÙ‚Øª Ø§Ù„Ø°Ø±ÙˆØ©
  rewatchCount    Int   @default(0) @map("rewatch_count")

  // Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
  mobileViews  Int @default(0) @map("mobile_views")
  desktopViews Int @default(0) @map("desktop_views")
  tabletViews  Int @default(0) @map("tablet_views")

  // ØªØ­Ù„ÙŠÙ„ ÙˆÙ‚ØªÙŠ
  hourlyDistribution Json? @map("hourly_distribution") // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø©
  dailyDistribution  Json? @map("daily_distribution") // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…

  lastCalculated DateTime @default(now()) @map("last_calculated")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @default(now()) @map("updated_at")

  // Relations
  post Post @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([totalViews])
  @@index([engagementRate])
  @@index([completionRate])
  @@index([lastCalculated])
  @@map("video_metrics")
}

// ===============================
// ğŸ‘¥ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
// ===============================

model UserFollow {
  id         String @id @default(uuid())
  followerId String @map("follower_id")
  followedId String @map("followed_id")

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
  isNotificationEnabled Boolean @default(true) @map("is_notification_enabled")
  source                String? @map("source") // suggestion, search, mutual, etc.

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  follower User @relation("UserFollowers", fields: [followerId], references: [id], onDelete: Cascade)
  followed User @relation("UserFollowing", fields: [followedId], references: [id], onDelete: Cascade)

  @@unique([followerId, followedId])
  @@index([followerId])
  @@index([followedId])
  @@index([createdAt])
  @@map("user_follows")
}

// ===============================
// ğŸ“Š Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
// ===============================

model SystemLog {
  id         String   @id @default(uuid())
  type       String // Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (INTEREST_OPTIMIZATION, VIDEO_ANALYTICS, etc.)
  status     String // Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (SUCCESS, ERROR, WARNING)
  details    Json? // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
  executedAt DateTime @default(now()) @map("executed_at")

  createdAt DateTime @default(now()) @map("created_at")

  @@index([type])
  @@index([status])
  @@index([executedAt])
  @@map("system_logs")
}

// ===============================
// ğŸ’š Ù†Ø¸Ø§Ù… Ø§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø£ÙØ¶Ù„ - Best Friend System
// ===============================

// Ø­Ø§Ù„Ø§Øª Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø£ÙØ¶Ù„
enum BestFriendStatus {
  PENDING // ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
  ACTIVE // Ù†Ø´Ø·
  EXPIRED // Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
  REJECTED // Ù…Ø±ÙÙˆØ¶
  CANCELLED // Ù…Ù„ØºÙŠ
  PAUSED // Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹
}

// Ø£Ù†ÙˆØ§Ø¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
enum BestFriendPermissionType {
  POST_ON_PROFILE // Ù†Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
  COMMENT_SPECIAL // ØªØ¹Ù„ÙŠÙ‚ Ø®Ø§Øµ
  STORY_VIEW // Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù‚ØµØµ
  PROFILE_ACCESS // Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
}

// Ù‚ÙˆØ© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡
enum RelationshipStrength {
  WEAK // Ø¶Ø¹ÙŠÙ (0-30 Ù†Ù‚Ø·Ø©)
  MODERATE // Ù…ØªÙˆØ³Ø· (31-60 Ù†Ù‚Ø·Ø©) 
  STRONG // Ù‚ÙˆÙŠ (61-90 Ù†Ù‚Ø·Ø©)
  VERY_STRONG // Ù‚ÙˆÙŠ Ø¬Ø¯Ø§Ù‹ (91+ Ù†Ù‚Ø·Ø©)
}

// Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ø§Ù„Ù…Ù‚Ø±Ø¨ÙŠÙ†
model BestFriendRelation {
  id String @id @default(uuid())

  // Ø§Ù„Ø·Ø±ÙØ§Ù† ÙÙŠ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© (Ø¹Ù„Ø§Ù‚Ø© Ø«Ù†Ø§Ø¦ÙŠØ© Ø§Ù„Ø§ØªØ¬Ø§Ù‡)
  user1Id String @map("user_1_id")
  user2Id String @map("user_2_id")

  // Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ¨Ø§Ø¯Ù„ÙŠØ©
  totalPoints Float @default(0) @map("total_points") // Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø¬Ù…Ø¹Ø© Ù„Ù„Ø·Ø±ÙÙŠÙ†
  user1Points Float @default(0) @map("user_1_points") // Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„
  user2Points Float @default(0) @map("user_2_points") // Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
  mutualScore Float @default(0) @map("mutual_score") // Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…ØªØ¨Ø§Ø¯Ù„

  // Ù‚ÙˆØ© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„
  relationshipStrength RelationshipStrength @default(WEAK) @map("relationship_strength")
  compatibilityScore   Float                @default(0) @map("compatibility_score") // Ø¯Ø±Ø¬Ø© Ø§Ù„ØªÙˆØ§ÙÙ‚ 0-1
  interactionFrequency Float                @default(0) @map("interaction_frequency") // ØªÙƒØ±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„

  // ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© (Ø¯ÙˆØ±Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†)
  startDate       DateTime  @map("start_date")
  endDate         DateTime  @map("end_date")
  nominatedAt     DateTime  @default(now()) @map("nominated_at")
  decidedAt       DateTime? @map("decided_at") // ØªØ§Ø±ÙŠØ® Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±
  lastInteraction DateTime? @map("last_interaction") // Ø¢Ø®Ø± ØªÙØ§Ø¹Ù„ Ù…Ø´ØªØ±Ùƒ

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© ÙˆÙ…Ù† Ø¨Ø¯Ø£Ù‡Ø§
  status      BestFriendStatus @default(PENDING)
  nominatedBy String           @map("nominated_by") // Ù…Ù† Ø±Ø´Ø­ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© (user1Id Ø£Ùˆ user2Id Ø£Ùˆ "system")
  approvedBy  String?          @map("approved_by") // Ù…Ù† ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø­Ø¯ÙˆØ¯
  postsUsed         Int     @default(0) @map("posts_used") // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 1)
  commentsUsed      Int     @default(0) @map("comments_used") // Ø¹Ø¯Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10)
  approvalsRequired Boolean @default(true) @map("approvals_required") // Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚Ø© Ù„Ù„Ø£Ù†Ø´Ø·Ø©

  // ØªØ±Ø´ÙŠØ­ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø£Ù… ÙŠØ¯ÙˆÙŠ
  isAutoNominated Boolean @default(false) @map("is_auto_nominated") // ØªØ±Ø´ÙŠØ­ ØªÙ„Ù‚Ø§Ø¦ÙŠ (ØªÙÙˆÙ‚ ÙˆØ§Ø¶Ø­)
  wasManualChoice Boolean @default(false) @map("was_manual_choice") // Ø§Ø®ØªÙŠØ§Ø± ÙŠØ¯ÙˆÙŠ (Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ø§ÙˆÙŠ)

  // ØªØªØ¨Ø¹ Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ±Ø´ÙŠØ­
  nominationWeek String @map("nomination_week") // Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ±Ø´ÙŠØ­ (Ù…Ø«Ù„ "2025-W27")
  cycleNumber    Int    @default(1) @map("cycle_number") // Ø±Ù‚Ù… Ø§Ù„Ø¯ÙˆØ±Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ­Ù„ÙŠÙ„
  commonInterests String[] @map("common_interests") // Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©
  mutualFriends   Int      @default(0) @map("mutual_friends") // Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†
  sharedContent   Int      @default(0) @map("shared_content") // Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´ØªØ±Ùƒ

  // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ†
  user1Rating   Float? @map("user_1_rating") // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„ (1-5)
  user2Rating   Float? @map("user_2_rating") // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ (1-5)
  averageRating Float? @map("average_rating") // Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  user1 User @relation("BestFriendUser1", fields: [user1Id], references: [id], onDelete: Cascade)
  user2 User @relation("BestFriendUser2", fields: [user2Id], references: [id], onDelete: Cascade)

  // Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
  permissionRequests BestFriendPermissionRequest[]

  // Ø³Ø¬Ù„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©
  activityLogs BestFriendActivityLog[]

  // Ø§Ù„Ù‚ÙŠÙˆØ¯ ÙˆØ§Ù„ÙÙ‡Ø§Ø±Ø³
  @@unique([user1Id, user2Id, nominationWeek]) // Ø¹Ù„Ø§Ù‚Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹ ØªØ±Ø´ÙŠØ­
  @@index([user1Id])
  @@index([user2Id])
  @@index([status])
  @@index([startDate])
  @@index([endDate])
  @@index([nominationWeek])
  @@index([totalPoints])
  @@index([relationshipStrength])
  @@index([nominatedAt])
  @@map("best_friend_relations")
}

// Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø®Ø§ØµØ©
model BestFriendPermissionRequest {
  id String @id @default(uuid())

  relationId  String @map("relation_id")
  requesterId String @map("requester_id") // Ù…Ù† Ø·Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
  approverId  String @map("approver_id") // Ù…Ù† Ø³ÙŠÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§

  permissionType BestFriendPermissionType @map("permission_type")
  status         String                   @default("pending") // pending, approved, rejected, expired

  // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
  requestDetails String? @map("request_details") // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ (Ù…Ø«Ù„ Ù†Øµ Ø§Ù„Ù…Ù†Ø´ÙˆØ±)
  approvalReason String? @map("approval_reason") // Ø³Ø¨Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø£Ùˆ Ø§Ù„Ø±ÙØ¶

  // ØªÙˆØ§Ø±ÙŠØ® Ù…Ù‡Ù…Ø©
  requestedAt DateTime  @default(now()) @map("requested_at")
  respondedAt DateTime? @map("responded_at")
  expiresAt   DateTime  @map("expires_at") // Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø·Ù„Ø¨ (24 Ø³Ø§Ø¹Ø©)

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @map("updated_at")

  // Relations
  relation  BestFriendRelation @relation(fields: [relationId], references: [id], onDelete: Cascade)
  requester User               @relation("PermissionRequester", fields: [requesterId], references: [id], onDelete: Cascade)
  approver  User               @relation("PermissionApprover", fields: [approverId], references: [id], onDelete: Cascade)

  @@index([relationId])
  @@index([requesterId])
  @@index([approverId])
  @@index([permissionType])
  @@index([status])
  @@index([expiresAt])
  @@map("best_friend_permission_requests")
}

// Ø³Ø¬Ù„ Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ø§Ù„Ù…Ù‚Ø±Ø¨ÙŠÙ†
model BestFriendActivityLog {
  id String @id @default(uuid())

  relationId String @map("relation_id")
  userId     String @map("user_id") // Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„Ù†Ø´Ø§Ø·

  activityType String @map("activity_type") // Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·
  description  String // ÙˆØµÙ Ø§Ù„Ù†Ø´Ø§Ø·
  metadata     Json? // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©

  pointsAwarded Float @default(0) @map("points_awarded") // Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ù…Ù†ÙˆØ­Ø© Ù„Ù„Ù†Ø´Ø§Ø·

  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  relation BestFriendRelation @relation(fields: [relationId], references: [id], onDelete: Cascade)
  user     User               @relation("BestFriendActivities", fields: [userId], references: [id], onDelete: Cascade)

  @@index([relationId])
  @@index([userId])
  @@index([activityType])
  @@index([createdAt])
  @@map("best_friend_activity_logs")
}

// ===============================
// ğŸ“± Ù†Ø¸Ø§Ù… Ø§Ù„ØªØªØ¨Ø¹ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
// ===============================

// ØªØªØ¨Ø¹ Ø³Ù„ÙˆÙƒ Ø§Ù„ØªÙ…Ø±ÙŠØ±
model UserScrollTracking {
  id String @id @default(uuid())

  userId String @map("user_id")
  postId String @map("post_id")

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠØ±
  scrollDepth  Float  @map("scroll_depth") // Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ± (0-100%)
  timeOnPost   Float  @map("time_on_post") // ÙˆÙ‚Øª Ù‚Ø¶Ø§Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ± (Ø«ÙˆØ§Ù†ÙŠ)
  pauseTime    Float  @map("pause_time") // ÙˆÙ‚Øª Ø§Ù„ØªÙˆÙ‚Ù (Ø«ÙˆØ§Ù†ÙŠ)
  scrollSpeed  Float  @map("scroll_speed") // Ø³Ø±Ø¹Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ± (px/second)
  isVisible    Boolean @map("is_visible") // Ù‡Ù„ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ù…Ø±Ø¦ÙŠ
  
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©
  viewportData Json @map("viewport_data") // Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØ¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø±Ø¶
  
  sessionId String @map("session_id") // Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ù„Ø³Ø©
  timestamp DateTime @default(now())

  // Relations
  user User @relation("UserScrollTracking", fields: [userId], references: [id], onDelete: Cascade)
  post Post @relation("PostScrollTracking", fields: [postId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([postId])
  @@index([sessionId])
  @@index([timestamp])
  @@map("user_scroll_tracking")
}

// ØªØªØ¨Ø¹ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
model UserVideoTracking {
  id String @id @default(uuid())

  userId String @map("user_id")
  postId String @map("post_id")

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  videoDuration     Float   @map("video_duration") // Ù…Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø«ÙˆØ§Ù†ÙŠ)
  watchedDuration   Float   @map("watched_duration") // Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© (Ø«ÙˆØ§Ù†ÙŠ)
  watchedPercentage Float   @map("watched_percentage") // Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© (0-100%)
  
  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙØ§Ø¹Ù„
  playCount  Int @map("play_count") // Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„
  pauseCount Int @map("pause_count") // Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù
  seekCount  Int @map("seek_count") // Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…/Ø§Ù„ØªØ£Ø®ÙŠØ±
  
  isCompleted Boolean @map("is_completed") // Ù‡Ù„ Ø£ÙƒÙ…Ù„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
  exitPoint   Float   @map("exit_point") // Ù†Ù‚Ø·Ø© Ø§Ù„Ø®Ø±ÙˆØ¬ (Ø«Ø§Ù†ÙŠØ©)
  
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  interactionData Json @map("interaction_data") // ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØµÙˆØª
  
  sessionId String @map("session_id")
  timestamp DateTime @default(now())

  // Relations
  user User @relation("UserVideoTracking", fields: [userId], references: [id], onDelete: Cascade)
  post Post @relation("PostVideoTracking", fields: [postId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([postId])
  @@index([sessionId])
  @@index([timestamp])
  @@index([isCompleted])
  @@map("user_video_tracking")
}

// ØªØªØ¨Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
model UserInteractionTracking {
  id String @id @default(uuid())

  userId String @map("user_id")
  postId String @map("post_id")

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„
  interactionType UserEngagementType @map("interaction_type")
  timeToInteract  Float @map("time_to_interact") // Ø§Ù„ÙˆÙ‚Øª Ù…Ù† Ø§Ù„Ø±Ø¤ÙŠØ© Ù„Ù„ØªÙØ§Ø¹Ù„ (Ø«ÙˆØ§Ù†ÙŠ)
  scrollPosition  Float @map("scroll_position") // Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„
  
  // Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ù‚Ø±
  clickPosition Json @map("click_position") // {x, y}
  
  deviceType String @map("device_type") // Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²
  sessionId  String @map("session_id")
  timestamp  DateTime @default(now())

  // Relations
  user User @relation("UserInteractionTracking", fields: [userId], references: [id], onDelete: Cascade)
  post Post @relation("PostInteractionTracking", fields: [postId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([postId])
  @@index([interactionType])
  @@index([sessionId])
  @@index([timestamp])
  @@map("user_interaction_tracking")
}

// Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙƒÙŠ
model SmartUserProfile {
  id String @id @default(uuid())

  userId String @unique @map("user_id")

  // Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ù„ÙˆÙƒ
  profileType String @map("profile_type") // Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³ØªÙ†ØªØ¬
  
  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙ…Ø±ÙŠØ±
  avgTimeOnPost   Float @map("avg_time_on_post")
  avgScrollSpeed  Float @map("avg_scroll_speed")
  avgPauseTime    Float @map("avg_pause_time")
  scrollEngagementRate Float @map("scroll_engagement_rate")
  
  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  avgWatchPercentage Float @map("avg_watch_percentage")
  videoCompletionRate Float @map("video_completion_rate")
  avgPlayCount       Float @map("avg_play_count")
  videoEngagementIndicator Float @map("video_engagement_indicator")
  
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  behaviorData Json @map("behavior_data") // ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ÙØµÙ„Ø©
  
  lastAnalyzed DateTime @map("last_analyzed")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @default(now()) @map("updated_at")

  // Relations
  user User @relation("UserSmartProfiles", fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([profileType])
  @@index([lastAnalyzed])
  @@map("smart_user_profiles")
}
